- type: custom-api
  title: Air Quality
  cache: 10m
  url: https://api.waqi.info/feed/geo:${LAT};${LON}/?token=${AQI_TOKEN}
  template: |
    {{ $aqi := printf "%03s" (.JSON.String "data.aqi") }}
    {{ $aqiraw := .JSON.String "data.aqi" }}
    {{ $updated := .JSON.String "data.time.iso" }}
    {{ $humidity := .JSON.String "data.iaqi.h.v" }}
    {{ $ozone := .JSON.String "data.iaqi.o3.v" }}
    {{ $pm25 := .JSON.String "data.iaqi.pm25.v" }}
    {{ $pressure := .JSON.String "data.iaqi.p.v" }}

    <div class="flex justify-between">
      <div class="size-h5">
        {{ if le $aqi "050" }}
          <div class="color-positive">Good air quality</div>
        {{ else if le $aqi "100" }}
          <div class="color-primary">Moderate air quality</div>
        {{ else }}
          <div class="color-negative">Bad air quality</div>
        {{ end }}
      </div>
    </div>

    <div class="color-highlight size-h2">AQI: {{ $aqiraw }}</div>
    <div style="border-bottom: 1px solid; margin-block: 10px;"></div>

    <div class="margin-block-2">
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">

        <div>
          <div class="size-h3 color-highlight">{{ $humidity }}%</div>
          <div class="size-h6">HUMIDITY</div>
        </div>

        <div>
          <div class="size-h3 color-highlight">{{ $ozone }} μg/m³</div>
          <div class="size-h6">OZONE</div>
        </div>

        <div>
          <div class="size-h3 color-highlight">{{ $pm25 }} μg/m³</div>
          <div class="size-h6">PM2.5</div>
        </div>

        <div>
          <div class="size-h3 color-highlight">{{ $pressure }} hPa</div>
          <div class="size-h6">PRESSURE</div>
        </div>

      </div>

      <div class="size-h6" style="margin-top: 10px;">Last Updated at {{ slice $updated 11 16 }}</div>
    </div>
